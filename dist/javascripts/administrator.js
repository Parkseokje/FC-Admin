"use strict";window.requirejs(["common"],function(a){function t(a){window.axios.get("/administrator/admin/offices",{params:{id:a}}).then(function(a){var t=a.data;if(t.length>0){_.prop("disabled",!1);var i=c("#table-admin-offices").DataTable();i.clear().draw(),i.rows.add(t),i.columns.adjust().draw()}else y.prop("disabled",!0)}).catch(function(a){console.error(a)})}var i,n,e,o=this,c=c||window.$,r=window.$("#select-branch-list"),d=c("#select-office"),s=[],l=window.$(".btn-assign-branch"),u=window.$(".btn-assign-branch-submit"),f=c(".branch-right-buttons > #clear-input"),m=c(".branch-right-buttons > .btn-submit"),b=c("#btnDisableBranch"),p=c(".duty-right-buttons > #clear-input"),w=c(".duty-right-buttons > .btn-submit"),h=c("#btnDisableDuty"),v=c(".office-right-buttons > #clear-input"),g=c(".office-right-buttons > .btn-submit"),k=c("#btnDisableOffice"),y=c("#btn-save-office-branches"),_=c("#btn-save-admin-offices"),$=c("#frm-regist-office"),x=c("#frm_create_branch"),D=c("#frm_create_duty"),T=c("#check-all-branches"),N=c("#check-all-admin-offices"),j=window.$("#draggablePanelList"),E=c(".duty-list > a"),C=null;c(function(){y.prop("disabled",!0),_.prop("disabled",!0),c("#select-branch-list").select2(),a.initDataTable(c("#table-branch"),{buttons:[]}),i=a.initDataTable(c("#table-office-branches"),{columns:[{data:"active",render:function(a,t,i){return"display"===t?'<input type="checkbox" class="editor-active">':a},className:"dt-body-center",orderDataType:"dom-checkbox"},{data:"branch_name",className:"center"},{data:"branch_id",className:"center",visible:!1}],buttons:[],rowCallback:function(a,t){1===t.active&&window.$("input.editor-active",a).prop("checked",!0)}}),n=a.initDataTable(c("#table-admin-offices"),{columns:[{data:"active",render:function(a,t,i){return"display"===t?'<input type="checkbox" class="editor-active">':a},className:"dt-body-center",orderDataType:"dom-checkbox"},{data:"office_name",className:"center"},{data:"office_id",className:"center",visible:!1}],buttons:[],rowCallback:function(a,t){1===t.active&&window.$("input.editor-active",a).prop("checked",!0)}}),a.initDataTable(c("#table_administrator")),a.initDataTable(c("#table-office"),{buttons:[]})}),T.bind("click",function(){c(":checkbox",i.rows().nodes()).prop("checked",this.checked)}),N.bind("click",function(){c(":checkbox",n.rows().nodes()).prop("checked",this.checked)}),y.bind("click",function(){if(!window.confirm("자료를 저장하시겠습니까?"))return!1;y.prop("disabled",!0);var a=c(":checkbox:checked",i.rows({filter:"applied"}).nodes()).map(function(){return i.row(window.$(this).parents("tr")).data().branch_id}).get().join(", ");window.axios.post("/administrator/office/branches",{office_id:d.val(),branch_ids:a}).then(function(a){a.data&&(y.prop("disabled",!1),!1!==a.data.success?window.alert("자료를 저장하였습니다."):(window.alert("자료를 저장하지 못하였습니다."),console.log(a.data.message)))})}),_.bind("click",function(){if(null==e)return!1;if(!window.confirm("자료를 저장하시겠습니까?"))return!1;_.prop("disabled",!0);var a=c(":checkbox:checked",n.rows({filter:"applied"}).nodes()).map(function(){return n.row(window.$(this).parents("tr")).data().office_id}).get().join(", ");window.axios.post("/administrator/admin/offices",{admin_id:e,office_ids:a}).then(function(a){a.data&&(_.prop("disabled",!1),!1!==a.data.success?window.alert("자료를 저장하였습니다."):(window.alert("자료를 저장하지 못하였습니다."),console.log(a.data.message)))})}),d.change(function(){var a=c(this).val();window.axios.get("/administrator/offices",{params:{id:a}}).then(function(a){var t=a.data.list;if(t.length>0){y.prop("disabled",!1);var i=c("#table-office-branches").DataTable();i.clear().draw(),i.rows.add(t),i.columns.adjust().draw()}else y.prop("disabled",!0)}).catch(function(a){console.error(a)})}),c("#assignAdminOffices").on("show.bs.modal",function(a){var i=c(a.relatedTarget);e=i.data("user-id"),t(e)}),window.$("#table_administrator").on("click",".btn-delete-admin",function(){if(!window.confirm("삭제 시 되돌릴 수 없습니다. 정말 삭제하시겠습니까?"))return!1;var a={id:window.$(o).data("user-id")};window.axios.delete("/administrator",{params:a}).then(function(a){a.data.success?window.alert("관리자를 삭제하였습니다."):window.alert("관리자를 삭제하지 못했습니다."),window.location.reload()}).catch(function(a){console.log(a)})}),window.administrator={removeElement:function(a){return c(a).parent().parent().remove(),s=q(),!1}},window.$(".btn-modify-admininfo").bind("click",function(a){var t=window.$(a.currentTarget),i=t.attr("data-user-name"),n=t.attr("data-user-email"),e=t.attr("data-user-role"),o=t.attr("data-url"),c=window.$("#frm_modify_admin");C=t.attr("data-user-id"),c.find("#name").val(i),c.find("#email").val(n),c.find(".employee_id").val(C),c.find("#select_authority").val(e),c.attr("action",o)}),window.$(".btn-modify-role").bind("click",function(a){var t=window.$(a.currentTarget),i=t.attr("data-user-role"),n=window.$("#frm_change_admin_role");C=t.attr("data-user-id"),n.find(".user_id").val(C),n.find("#select_authority").val(i)}),window.$(".btn-add-branch").bind("click",function(a){var t=window.$(a.currentTarget),i=window.$("#frm_assign_branch");C=t.attr("data-user-id"),i.find(".user_id").val(C),window.axios({method:"get",url:"/administrator/branch/"+C}).then(function(a){a.data.success?(s=[],j.empty(),a.data.list.forEach(function(a){var t=L(a.id,a.name);j.append(t),s.push([C,a.id])})):window.alert("알 수 없는 오류가 발생했습니다. 잠시 후에 다시 시도해주세요.")})}),l.bind("click",function(){var a=r.find("option:selected").text().trim(),t=r.find("option:selected").val().trim();if(!P(t)){var i=L(t,a);j.append(i),s.push([C,t])}});var L=function(a,t){return'<li class="list-group-item" data-branch-id="'+a+'"><div class="course">'+t+'<a href="#" class="btn-delete-course" onclick="administrator.removeElement(this);"> <i class="fa fa-remove text-red"></i></a> </div></li>'},O=window.$("#draggablePanelList");O.sortable({handle:".course",update:function(){s=q()}});var P=function(a){for(var t=0,i=s.length;t<i;t++)if(s[t][1]==a)return!0;return!1},q=function(){var a=[];return window.$(".list-group-item",O).each(function(t,i){var n=[C,window.$(i).attr("data-branch-id")];a.push(n)}),a};u.bind("click",function(a){if(a.preventDefault(),s.length<=0)return void window.alert("점포을 추가하세요.");window.axios({method:"post",url:"/administrator/assign/branch",data:{user_id:C,branch_list:s}}).then(function(a){a.data.success?window.alert("점포을 배정하였습니다."):(console.log(a.data.msg),window.alert("알 수 없는 오류가 발생했습니다. 잠시 후에 다시 시도해주세요.")),window.location.reload()})}),c("#table-office").on("click",".office-list-item",function(a){a.preventDefault(),c(".office-input > input[name='id']").val(c(this).data("id")),c(".office-input > input[name='office_name']").val(c(this).data("office-name")),c(".office-input > textarea[name='office_desc']").val(c(this).data("office-desc")),$.attr("action","/administrator/modify/office"),g.html("수정"),k.prop("disabled",!1)}),v.bind("click",function(){c(".office-input > input[name='id']").val(""),c(".office-input > input[name='office_name']").val(""),c(".office-input > textarea[name='office_desc']").val(""),$.attr("action","/administrator/regist/office"),g.html("등록"),k.prop("disabled",!0)}),k.bind("click",function(){if(!window.confirm("삭제 시 되돌릴 수 없습니다. 정말 삭제하시겠습니까?"))return!1;var a={id:c(".office-input > input[name='id'").val()};window.axios.delete("/administrator/office",{params:a}).then(function(a){a.data.success?window.alert("지사를 삭제하였습니다."):window.alert("지사를 삭제하지 못했습니다."),window.location.reload()}).catch(function(a){console.log(a)})}),c("#table-branch").on("click",".branch-list-item",function(a){a.preventDefault(),c(".branch-input > input[name='id']").val(c(this).data("id")),c(".branch-input > input[name='name']").val(c(this).data("name")),x.attr("action","/employee/modify/branch"),m.html("수정"),b.prop("disabled",!1)}),f.bind("click",function(){c(".branch-input > input[name='id']").val(""),c(".branch-input > input[name='name']").val(""),x.attr("action","/employee/create/branch"),m.html("등록"),b.prop("disabled",!0)}),b.bind("click",function(){if(!confirm("삭제 시 되돌릴 수 없습니다. 정말 삭제하시겠습니까?"))return!1;var a={id:c(".branch-input > input[name='id'").val()};axios.delete("/employee/branch",{params:a}).then(function(a){a.data.success?alert("점포을 삭제하였습니다."):alert("점포을 삭제하지 못했습니다."),location.reload()}).catch(function(a){console.log(a)})}),E.bind("click",function(a){a.preventDefault(),c(".duty-input > input[name='id'").val(c(this).data("id")),c(".duty-input > input[name='name']").val(c(this).data("name")),D.attr("action","/employee/modify/duty"),w.html("수정"),h.prop("disabled",!1)}),p.bind("click",function(){c(".duty-input > input[name='id']").val(""),c(".duty-input > input[name='name']").val(""),D.attr("action","/employee/create/duty"),w.html("등록"),h.prop("disabled",!0)}),h.bind("click",function(){if(!confirm("삭제 시 되돌릴 수 없습니다. 정말 삭제하시겠습니까?"))return!1;var a={id:c(".duty-input > input[name='id'").val()};axios.delete("/employee/duty",{params:a}).then(function(a){a.data.success?alert("직책을 삭제하였습니다."):alert("직책을 삭제하지 못했습니다."),location.reload()}).catch(function(a){console.log(a)})})});
//# sourceMappingURL=../maps/administrator.js.map
