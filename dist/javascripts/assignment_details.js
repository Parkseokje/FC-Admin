"use strict";window.requirejs(["common"],function(e){var t=$(".btn-assign-education"),n=$("#delete-assignment"),a=$(".btn-submit"),i=$("#allocationEdu"),d=$("#modifyAssignment"),s=e.initDataTable($("#table-employee")),o=e.initDataTable($("#table-employee-assigned"),{columns:[{data:null,defaultContent:'<input type="checkbox",value="">'},{data:"branch_name",className:"center"},{data:"duty_name",className:"center"},{data:"user_name",className:"center"},{data:"user_phone",className:"center"},{data:"user_id",className:"center",visible:!1}]}),c=$("#check-all"),r=$("#check-all-assigned"),l=$(".message");$(function(){e.initDateTimePicker(i.find("#start_dt"),i.find("#end_dt")),e.initDateTimePicker(d.find("#start_dt"),d.find("#end_dt")),e.initDataTable($("#table_assignment_details")),e.initDataTable($("#table_assignment_history"))}),t.bind("click",function(){$("#allocationEdu .user_group_id").val($(".description.group_id").val()),$("#allocationEdu .bind_group_id").val($(".description.bind_group_id").val())}),n.bind("click",function(){if(!confirm("교육생 그룹을 삭제하시겠습니까?"))return!1;var e={id:$(this).data("id"),group_id:$(this).data("group-id")};axios.delete("/assignment",{params:e}).then(function(e){e.data.success?alert("교육생 그룹을 삭제하였습니다."):alert("교육생 그룹을 삭제하지 못했습니다. 관리자에게 문의하세요."),location.href="/assignment"}).catch(function(e){console.log(e)})}),$("#table_assignment_history").on("click",".btn-delete-assignment",function(){if(!confirm("삭제 시 되돌릴 수 없습니다. 정말 삭제하시겠습니까?"))return!1;var e={id:$(this).data("logassigneduid")};axios.delete("/assignment_history",{params:e}).then(function(e){e.data.success?alert("배정이력을 삭제하였습니다."):alert("배정이력을 삭제하지 못했습니다."),location.reload()}).catch(function(e){console.log(e)})}),$(".btn-modify-assignment").bind("click",function(){var e=$("#modifyAssignment");e.find(".user_group_id").val($(".description.group_id").val()),e.find(".bind_group_id").val($(".description.bind_group_id").val()),e.find("#start_dt").datetimepicker().children("input").val($(this).data("start")),e.find("#end_dt").datetimepicker().children("input").val($(this).data("end")),e.find("#log_assign_edu_id").val($(this).data("logassigneduid")),e.find("#eduName").html($(this).data("eduname"))}),c.bind("click",function(){$(":checkbox",s.rows().nodes()).prop("checked",this.checked)}),r.bind("click",function(){$(":checkbox",o.rows().nodes()).prop("checked",this.checked)}),$("#select-education").change(function(){var e=$(this).val();axios.get("/assignment/employees",{params:{edu_id:e}}).then(function(e){var t=e.data.data,n=$("#table-employee-assigned").DataTable();n.clear().draw(),n.rows.add(t),n.columns.adjust().draw()}).catch(function(e){console.error(e)})}),l.on("keyup",function(t){var n=window.$(t.currentTarget).val(),a=e.getBytes(n);90-a<0&&(window.alert("90 Bytes 를 초과할 수 없습니다."),n=e.cutBytes(n,90),window.$(t.currentTarget).val(n),window.$(t.currentTarget).focus(),a=e.getBytes(n)),window.$(".remain-bytes").html(a+" / 90 바이트")}),a.on("click",function(e){e.preventDefault();var t,n=window.$("ul.nav li.active").children().attr("id");switch(n){case"employee":t=window.$(":checkbox:checked",s.rows({filter:"applied"}).nodes()).map(function(){return s.row(window.$(this).parents("tr")).data()[4]}).get().join(",");break;case"employee-assigned":t=window.$(":checkbox:checked",o.rows({filter:"applied"}).nodes()).map(function(){return o.row(window.$(this).parents("tr")).data().user_phone}).get().join(",")}if(!t)return window.alert("직원을 선택하세요."),!1;var a=l.val().trim();return""===a?(window.alert("메세지를 입력하세요."),l.focus(),!1):!!window.confirm("메세지를 보내시겠습니까?")&&void window.axios({method:"post",url:"/api/v1/sms/send",data:{phones:t,msg:a}}).then(function(e){!0===e.data.success?window.alert("메세지를 전송하였습니다."):window.alert("알 수 없는 오류가 발생했습니다. 잠시 후에 다시 시도해주세요.")})})});
//# sourceMappingURL=../maps/assignment_details.js.map
