"use strict";window.define(["common","jquery.iframe-transport","jquery-ui/ui/widget","jquery.fileupload"],function(o){function n(o){e=this,e.extendOptions(o),e.init()}var e,t,a=a||window.$,i=i||window.axios;return n.prototype={options:{},extend:function(o,n){for(var e in n)n.hasOwnProperty(e)&&(o[e]=n[e]);return o},extendOptions:function(o){this.options=this.extend({},this.options),this.extend(this.options,o)},init:function(){e.getUploadInfo(),a("#cancel-button").attr("disabled",!0)},getUploadInfo:function(){i.get("/api/v1/fineuploader/token").then(function(o){var n=o.data;n&&(e.options.uploadUrl=n.uploadInfo.uploadUrl.replace("v4","cdnovp"),e.options.uploadCancelUrl=n.uploadInfo.uploadCancelUrl,e.options.token=n.uploadInfo.token,e.options.deploy_package_id=n.deploy_package_id,e.options.folder_id=n.folder_id,e.setJqueryFileUploader())})},cancelUpload:function(){i.post(e.options.uploadCancelUrl+"?token="+e.options.token,{token:e.options.token}).then(function(o){window.alert("업로드 취소"),window.location.reload()}).catch(function(o){console.log(o)})},setJqueryFileUploader:function(){console.log(e.options),a("#fileupload").attr("data-url",e.options.uploadUrl+"?token="+e.options.token);var o=new window.FormData;o.append("token",e.options.token),o.append("folder",e.options.folder_id),o.append("pkg",e.options.deploy_package_id),o.append("target_path",e.options.uploadFolder),a("#fileupload").fileupload({dataType:"json",singleFileUploads:!0,autoUpload:!1,acceptFileTypes:/(\.|\/)(mp4|avi)$/i,formData:o,replaceFileInput:!1,add:function(o,n){a("#upload-button").off("click").on("click",function(){a("#upload-button").attr("disabled",!0),a("#cancel-button").attr("disabled",!1),console.log(n),t=n.submit()})},done:function(o,n){var t=n.jqXHR.responseJSON;"None"===t.uploadInfo.errorInfo.errorCode?(window.alert("업로드 성공"),a("#fineUploader").modal("hide"),e.options.callback(n)):window.alert(t.uploadInfo.errorInfo.errorMessage),a("#upload-button").attr("disabled",!1),a("#cancel-button").attr("disabled",!0)},progressall:function(o,n){var e=parseInt(n.loaded/n.total*100,10);a("#progress-value").html(e+"%"),a("#progress .jquery-file-progress-bar").css("width",e+"%")}}),a("#fileupload").bind("fileuploadadd",function(o,n){a.each(n.files,function(o,n){a("#aqua-video-code").val("onm_"+n.name)}),a("#cancel-button").on("click",function(o){t.abort()})}),a("#fileupload").bind("fileuploadfail",function(o,n){"abort"===n.errorThrown&&e.cancelUpload()}),a("#fileupload").bind("fileuploadsubmit",function(o,n){})}},n});
//# sourceMappingURL=../../maps/components/jquery_uploader_service.js.map
