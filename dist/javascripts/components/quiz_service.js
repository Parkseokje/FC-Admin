"use strict";define(["common","quiz_component"],function(i){function t(i,t,e){n=this,n.extendOptions(i),n.extendData(t),n.isNew=null===t.course_list_id,n.callback=e,n.setOptions(i),n.init()}var e=require("quiz_component"),n=null;return t.prototype={options:{},data:{},quiz_list:[],extend:function(i,t){for(var e in t)t.hasOwnProperty(e)&&(i[e]=t[e]);return i},extendOptions:function(i){this.options=this.extend({},this.options),this.extend(this.options,i)},extendData:function(i){this.data=this.extend({},this.data),this.extend(this.data,i)},init:function(){if(n.data.quiz_list)for(var i=0;i<n.data.quiz_list.length;i++){var t=n.data.quiz_list[i];switch(t.quiz_type){case"A":n.addQuizSingleAnswer(t);break;case"B":n.addQuizMultiOptionWithOneAnswer(t);break;case"C":n.addQuizMultiOptionWithMultiAnswer(t)}}},setOptions:function(i){function t(i,t){for(var e in t)t.hasOwnProperty(e)&&(i[e]=t[e]);return i}n.options=t({},n.options),t(n.options,i)},getRandomString:function(){return axios.get("/api/v1/randomkey")},addQuizSingleAnswer:function(i){var t={wrapper:n.options.wrapper,parent:n,index:i?i.order:n.quiz_list.length};i||(i={quiz_id:null,type:n.data.type,quiz_type:"A",quiz_type_name:"단답형"});var u=new e(t,i);n.quiz_list.push(u)},addQuizMultiOptionWithOneAnswer:function(i){var t={wrapper:n.options.wrapper,parent:n,index:i?i.order:n.quiz_list.length},u=null;i?(u=new e(t,i),n.quiz_list.push(u)):(i={quiz_id:null,type:n.data.type,quiz_type:"B",quiz_type_name:"선택형",option_group_id:n.createGUID()},u=new e(t,i),n.quiz_list.push(u))},addQuizMultiOptionWithMultiAnswer:function(i){var t={wrapper:n.options.wrapper,parent:n,index:i?i.order:n.quiz_list.length},u=null;i?(t.index=i.order,u=new e(t,i),n.quiz_list.push(u)):(i={quiz_id:null,type:n.data.type,quiz_type:"C",quiz_type_name:"다답형",option_group_id:n.createGUID()},u=new e(t,i),n.quiz_list.push(u))},removeQuiz:function(i){if(!confirm("삭제하시겠습니까?"))return!1;i.isNew?(i.delete(),n.quiz_list.splice(i.options.index,1),n.updateQuizIndexes()):n.deleteQuiz(i)},deleteQuiz:function(i){axios.delete("/course/quiz",{params:{quiz_id:i.data.quiz_id,option_group_id:i.data.option_group_id}}).then(function(t){alert("퀴즈를 삭제하였습니다."),i.delete(),n.quiz_list.splice(i.options.index,1),n.updateQuizIndexes()}).catch(function(i){console.log(i)})},deleteQuizOption:function(i,t){axios.delete("/course/quiz/option",{params:{option_id:i}}).then(function(i){alert("보기를 삭제하였습니다."),t()}).catch(function(i){console.log(i)})},validateQuiz:function(){for(var i=!0,t=0;t<n.quiz_list.length;t++){if(!n.quiz_list[t].validate()){i=!1;break}}return i},saveSession:function(){var i=n.options.root_wrapper.find("#title").val();return n.isNew?axios({method:"post",url:"/course/quiz/courselist",data:{course_list_id:null,course_id:n.data.course_id,title:i,type:n.data.type,order:n.data.session_count+1,quiz_group_id:n.data.quiz_group_id}}):axios({method:"put",url:"/course/courselist",data:{course_list_id:n.data.course_list_id,course_list_order:n.data.course_list_order,title:i}})},saveQuiz:function(i){return i.setData(),i.isNew?axios({method:"post",url:"/course/quiz",data:{quiz_group_id:n.data.quiz_group_id,quiz:i.data}}):axios({method:"put",url:"/course/quiz",data:{quiz_group_id:n.data.quiz_group_id,quiz:i.data}})},saveSessionAndQuiz:function(){return n.quiz_list.length?!!n.validateQuiz()&&(!!confirm("자료를 저장하시겠습니까?")&&void axios.all([n.saveSession()]).then(axios.spread(function(i){var t=[];n.quiz_list.forEach(function(i){t.push(n.saveQuiz(i))}),axios.all(t).then(function(i){i.forEach(function(i){}),n.callback("success")})}))):(alert("등록된 퀴즈가 없습니다. 퀴즈 유형을 먼저 선택하세요."),!1)},updateQuizIndexes:function(){for(var i=n.quiz_list,t=0;t<i.length;t++)i[t].setIndex(t)},moveQuizIndexes:function(i,t){var e=n.quiz_list;e.splice(t,0,e.splice(i,1)[0]),n.updateQuizIndexes()},createGUID:function(){function i(){return(65536*(1+Math.random())|0).toString(16).substring(1)}return i()+i()+"-"+i()+"-"+i()+"-"+i()+"-"+i()+i()+i()}},t});
//# sourceMappingURL=../../maps/components/quiz_service.js.map
