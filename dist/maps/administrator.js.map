{"version":3,"sources":["administrator.js"],"names":["window","requirejs","Util","btnSaveOfficeBranches","prop","axios","get","params","console","then","response","newData","data","length","btnSaveAdminOffices","table","$","DataTable","id","draw","rows","add","columns","adjust","error","tableOfficeBranches","tableAdminOffices","selectedAdminId","_this","this","selectBranchList","selectOffice","branchIdList","btnAssignBranch","btnBranchSumit","btnBranchClearInputs","btnBranchSave","btnDeleteBranch","btnDutyClearInputs","btnDutySave","btnDeleteDuty","btnOfficeClearInputs","btnOfficeSave","btnDeleteOffice","formOffice","formBranch","formDuty","checkAllBranches","checkAllAdminOffices","branchContainer","dutyList","clickedUserId","select2","initDataTable","buttons","render","type","row","orderDataType","className","rowCallback","visible","active","bind","nodes","checked","confirm","office_id","val","filter","map","parents","join","res","branch_ids","checkedBranches","log","message","admin_id","office_ids","checkedOffices","post","change","officeId","alert","catch","list","$invoker","relatedTarget","clear","selectAdminOffices","adminId","e","on","removeElement","parent","remove","delete","_self","event","_role","attr","_name","_target","_action","el","reCountBranchList","currentTarget","find","_email","success","empty","forEach","append","elem","_id","method","url","checkDuplicateBranchId","obj","getItemElement","name","push","_text","text","trim","branchId","branchName","panelList","sortable","preventDefault","i","len","user_id","each","index","_tmp","branch_list","html","msg","reload","location"],"mappings":"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","file":"administrator.js","sourcesContent":["/**\n * Created by yijaejun on 30/11/2016.\n */\n\"use strict\";\nwindow.requirejs([\n  \"common\"\n],\nfunction (Util) {\n  var $ = $ || window.$;\n  var selectBranchList = window.$(\"#select-branch-list\");\n  var selectOffice = $(\"#select-office\");\n\n  var branchIdList = [];\n  var btnAssignBranch = window.$(\".btn-assign-branch\");\n  var btnBranchSumit = window.$(\".btn-assign-branch-submit\");\n  var btnBranchClearInputs = $(\".branch-right-buttons > #clear-input\");\n  var btnBranchSave = $(\".branch-right-buttons > .btn-submit\");\n  var btnDeleteBranch = $(\"#btnDisableBranch\");\n  var btnDutyClearInputs = $(\".duty-right-buttons > #clear-input\");\n  var btnDutySave = $(\".duty-right-buttons > .btn-submit\");\n  var btnDeleteDuty = $(\"#btnDisableDuty\");\n  var btnOfficeClearInputs = $(\".office-right-buttons > #clear-input\");\n  var btnOfficeSave = $(\".office-right-buttons > .btn-submit\");\n  var btnDeleteOffice = $(\"#btnDisableOffice\");\n  var btnSaveOfficeBranches = $(\"#btn-save-office-branches\");\n  var btnSaveAdminOffices = $(\"#btn-save-admin-offices\");\n\n  var tableOfficeBranches;\n  var tableAdminOffices;\n\n  var formOffice = $(\"#frm-regist-office\");\n  var formBranch = $(\"#frm_create_branch\");\n  var formDuty = $(\"#frm_create_duty\");\n\n  var checkAllBranches = $(\"#check-all-branches\");\n  var checkAllAdminOffices = $(\"#check-all-admin-offices\");\n\n  var branchContainer = window.$(\"#draggablePanelList\");\n  var dutyList = $(\".duty-list > a\");\n\n  var clickedUserId = null;\n  var selectedAdminId;\n\n  $(function () {\n    btnSaveOfficeBranches.prop(\"disabled\", true);\n    btnSaveAdminOffices.prop(\"disabled\", true);\n\n    $(\"#select-branch-list\").select2();\n\n    // datatable 설정\n    Util.initDataTable($(\"#table-branch\"), { buttons: [] });\n    tableOfficeBranches = Util.initDataTable($(\"#table-office-branches\"), {\n      \"columns\": [\n        {\n          \"data\": \"active\",\n          \"render\": function (data, type, row) {\n            if (type === \"display\") {\n              return \"<input type=\\\"checkbox\\\" class=\\\"editor-active\\\">\";\n            }\n            return data;\n          },\n          className: \"dt-body-center\",\n          orderDataType: \"dom-checkbox\"\n        },\n        // { 'data': null, defaultContent: '<input type=\"checkbox\",value=\"\">' },\n        { \"data\": \"branch_name\", className: \"center\" },\n        { \"data\": \"branch_id\", className: \"center\", visible: false }\n      ],\n      buttons: [],\n      rowCallback: function (row, data) {\n        // console.log(row, data);\n        if (data.active === 1) {\n          window.$(\"input.editor-active\", row).prop(\"checked\", true);\n        }\n        // window.$('input.editor-active', row).prop('checked', data.active === 1);\n      }\n    });\n    tableAdminOffices = Util.initDataTable($(\"#table-admin-offices\"), {\n      \"columns\": [\n        {\n          \"data\": \"active\",\n          \"render\": function (data, type, row) {\n            if (type === \"display\") {\n              return \"<input type=\\\"checkbox\\\" class=\\\"editor-active\\\">\";\n            }\n            return data;\n          },\n          className: \"dt-body-center\",\n          orderDataType: \"dom-checkbox\"\n        },\n        { \"data\": \"office_name\", className: \"center\" },\n        { \"data\": \"office_id\", className: \"center\", visible: false }\n      ],\n      buttons: [],\n      rowCallback: function (row, data) {\n        if (data.active === 1) {\n          window.$(\"input.editor-active\", row).prop(\"checked\", true);\n        }\n      }\n    });\n    Util.initDataTable($(\"#table_administrator\"));\n    Util.initDataTable($(\"#table-office\"), { buttons: [] });\n  });\n\n  checkAllBranches.bind(\"click\", function () {\n    $(\":checkbox\", tableOfficeBranches.rows().nodes()).prop(\"checked\", this.checked);\n  });\n\n  checkAllAdminOffices.bind(\"click\", function () {\n    $(\":checkbox\", tableAdminOffices.rows().nodes()).prop(\"checked\", this.checked);\n  });\n\n  btnSaveOfficeBranches.bind(\"click\", function () {\n    if (!window.confirm(\"자료를 저장하시겠습니까?\")) return false;\n\n    btnSaveOfficeBranches.prop(\"disabled\", true);\n\n    var checkedBranches =\n      $(\":checkbox:checked\", tableOfficeBranches.rows({filter: \"applied\"}).nodes()).map(\n        function () {\n          return tableOfficeBranches.row(window.$(this).parents(\"tr\")).data()[\"branch_id\"];\n        }\n      ).get().join(\", \");\n\n    window.axios.post(\"/administrator/office/branches\", {\n      office_id: selectOffice.val(),\n      branch_ids: checkedBranches\n    })\n    .then(function (res) {\n      if (res.data) {\n        btnSaveOfficeBranches.prop(\"disabled\", false);\n        if (res.data.success !== false) {\n          window.alert(\"자료를 저장하였습니다.\");\n        } else {\n          window.alert(\"자료를 저장하지 못하였습니다.\");\n          console.log(res.data.message);\n        }\n      }\n    });\n  });\n\n  btnSaveAdminOffices.bind(\"click\", function () {\n    if (selectedAdminId == null) return false;\n    if (!window.confirm(\"자료를 저장하시겠습니까?\")) return false;\n\n    btnSaveAdminOffices.prop(\"disabled\", true);\n\n    var checkedOffices =\n      $(\":checkbox:checked\", tableAdminOffices.rows({filter: \"applied\"}).nodes()).map(\n        function () {\n          return tableAdminOffices.row(window.$(this).parents(\"tr\")).data()[\"office_id\"];\n        }\n      ).get().join(\", \");\n\n    window.axios.post(\"/administrator/admin/offices\", {\n      admin_id: selectedAdminId,\n      office_ids: checkedOffices\n    })\n    .then(function (res) {\n      if (res.data) {\n        btnSaveAdminOffices.prop(\"disabled\", false);\n        if (res.data.success !== false) {\n          window.alert(\"자료를 저장하였습니다.\");\n        } else {\n          window.alert(\"자료를 저장하지 못하였습니다.\");\n          console.log(res.data.message);\n        }\n      }\n    });\n  });\n\n  selectOffice.change(function () {\n    var officeId = $(this).val();\n\n    window.axios.get(\"/administrator/offices\", {\n      params: {\n        id: officeId\n      }\n    })\n    .then(function (response) {\n      var newData = response.data.list;\n\n      if (newData.length > 0) {\n        btnSaveOfficeBranches.prop(\"disabled\", false);\n        var table = $(\"#table-office-branches\").DataTable();\n\n        table.clear().draw();\n        table.rows.add(newData); // Add new data\n        table.columns.adjust().draw(); // Redraw the DataTable\n      } else {\n        btnSaveOfficeBranches.prop(\"disabled\", true);\n      }\n    })\n    .catch(function (error) {\n      console.error(error);\n    });\n  });\n\n  $(\"#assignAdminOffices\").on(\"show.bs.modal\", function (e) {\n    var $invoker = $(e.relatedTarget);\n\n    selectedAdminId = $invoker.data(\"user-id\");\n    selectAdminOffices(selectedAdminId);\n  });\n\n  function selectAdminOffices (adminId) {\n    window.axios.get(\"/administrator/admin/offices\", {\n      params: {\n        id: adminId\n      }\n    })\n    .then(function (response) {\n      var newData = response.data;\n      // console.log(newData);\n\n      if (newData.length > 0) {\n        btnSaveAdminOffices.prop(\"disabled\", false);\n        var table = $(\"#table-admin-offices\").DataTable();\n\n        table.clear().draw();\n        table.rows.add(newData);\n        table.columns.adjust().draw();\n      } else {\n        btnSaveOfficeBranches.prop(\"disabled\", true);\n      }\n    })\n    .catch(function (error) {\n      console.error(error);\n    });\n  }\n\n  // 관리자 삭제하기\n  window.$(\"#table_administrator\").on(\"click\", \".btn-delete-admin\", () => {\n    if (!window.confirm(\"삭제 시 되돌릴 수 없습니다. 정말 삭제하시겠습니까?\")) {\n      return false;\n    }\n\n    const params = {\n      id: window.$(this).data(\"user-id\")\n    };\n\n    window.axios.delete(\"/administrator\",\n      {\n        params: params\n      })\n      .then((response) => {\n        if (!response.data.success) {\n          window.alert(\"관리자를 삭제하지 못했습니다.\");\n        } else {\n          window.alert(\"관리자를 삭제하였습니다.\");\n        }\n        window.location.reload();\n      })\n      .catch((error) => {\n        console.log(error);\n      });\n  });\n\n  window.administrator = {\n    removeElement: function (el) {\n      $(el).parent().parent().remove();\n      branchIdList = reCountBranchList();\n      return false;\n    }\n  };\n\n  // 관리자 정보 수정\n  window.$(\".btn-modify-admininfo\").bind(\"click\", (event) => {\n    const _self = window.$(event.currentTarget);\n    const _name = _self.attr(\"data-user-name\");\n    const _email = _self.attr(\"data-user-email\");\n    const _role = _self.attr(\"data-user-role\");\n    const _action = _self.attr(\"data-url\");\n    const _target = window.$(\"#frm_modify_admin\");\n\n    clickedUserId = _self.attr(\"data-user-id\");\n\n    _target.find(\"#name\").val(_name);\n    _target.find(\"#email\").val(_email);\n    _target.find(\".employee_id\").val(clickedUserId);\n    _target.find(\"#select_authority\").val(_role);\n    _target.attr(\"action\", _action);\n  });\n\n  // role 수정\n  window.$(\".btn-modify-role\").bind(\"click\", (event) => {\n    const _self = window.$(event.currentTarget);\n    const _role = _self.attr(\"data-user-role\");\n    const _target = window.$(\"#frm_change_admin_role\");\n\n    clickedUserId = _self.attr(\"data-user-id\");\n\n    _target.find(\".user_id\").val(clickedUserId);\n    _target.find(\"#select_authority\").val(_role);\n  });\n\n  // supervisor 점포배정\n  window.$(\".btn-add-branch\").bind(\"click\", (event) => {\n    const _self = window.$(event.currentTarget);\n    const _target = window.$(\"#frm_assign_branch\");\n\n    clickedUserId = _self.attr(\"data-user-id\");\n    _target.find(\".user_id\").val(clickedUserId);\n\n    window.axios({\n      method: \"get\",\n      url: \"/administrator/branch/\" + clickedUserId\n    }).then((res) => {\n      if (res.data.success) {\n        branchIdList = [];\n        branchContainer.empty();\n\n        res.data.list.forEach((obj) => {\n          let elem = getItemElement(obj.id, obj.name);\n          branchContainer.append(elem);\n          branchIdList.push([clickedUserId, obj.id]);\n        });\n      } else {\n        window.alert(\"알 수 없는 오류가 발생했습니다. 잠시 후에 다시 시도해주세요.\");\n      }\n    });\n  });\n\n  // 점포 추가\n  btnAssignBranch.bind(\"click\", () => {\n    const _text = selectBranchList.find(\"option:selected\").text().trim();\n    const _id = selectBranchList.find(\"option:selected\").val().trim();\n\n    if (!checkDuplicateBranchId(_id)) {\n      const elem = getItemElement(_id, _text);\n      branchContainer.append(elem);\n      branchIdList.push([clickedUserId, _id]);\n    }\n  });\n\n  // 점포 템플릿에 데이터를 바인딩 후 반환한다.\n  const getItemElement = (branchId, branchName) => {\n    return \"<li class=\\\"list-group-item\\\" data-branch-id=\\\"\" + branchId + \"\\\">\" +\n      \"<div class=\\\"course\\\">\" + branchName + \"<a href=\\\"#\\\" class=\\\"btn-delete-course\\\" onclick=\\\"administrator.removeElement(this);\\\">\" +\n      \" <i class=\\\"fa fa-remove text-red\\\"></i></a>\" +\n      \" </div>\" +\n      \"</li>\";\n  };\n\n  // ref. http://www.bootply.com/dUQiGMggWO\n  const panelList = window.$(\"#draggablePanelList\");\n  panelList.sortable({\n    handle: \".course\",\n    update: () => {\n      branchIdList = reCountBranchList();\n    }\n  });\n\n  // 추가한 강의중에 중복이 있는지 확인을 한다.\n  const checkDuplicateBranchId = (id) => {\n    for (let i = 0, len = branchIdList.length; i < len; i++) {\n      if (branchIdList[i][1] == id) {\n        return true;\n      }\n    }\n    return false;\n  };\n\n  // 점포 리스트를 다시 점검한다\n  const reCountBranchList = () => {\n    let _tmp = [];\n    window.$(\".list-group-item\", panelList).each((index, elem) => {\n      let _id = [ clickedUserId, window.$(elem).attr(\"data-branch-id\") ];\n      _tmp.push(_id);\n    });\n    return _tmp;\n  };\n\n  btnBranchSumit.bind(\"click\", (e) => {\n    e.preventDefault();\n\n    // Validation check\n    if (branchIdList.length <= 0) {\n      window.alert(\"점포을 추가하세요.\");\n      return;\n    }\n\n    window.axios({\n      method: \"post\",\n      url: \"/administrator/assign/branch\",\n      data: {\n        user_id: clickedUserId,\n        branch_list: branchIdList\n      }\n    }).then((res) => {\n      if (res.data.success) {\n        window.alert(\"점포을 배정하였습니다.\");\n      } else {\n        console.log(res.data.msg);\n        window.alert(\"알 수 없는 오류가 발생했습니다. 잠시 후에 다시 시도해주세요.\");\n      }\n\n      window.location.reload();\n    });\n  });\n\n  // 지사 ..등록모드에서 수정모드로 변경\n  // 2nd 페이지에서 이벤트 안먹히는 증상 (http://stackoverflow.com/questions/25414778/jquery-onclick-not-working-in-datatables-2nd-page-or-rows-past-11)\n  $(\"#table-office\").on(\"click\", \".office-list-item\", function (e) {\n    e.preventDefault();\n    $(\".office-input > input[name='id']\").val($(this).data(\"id\"));\n    $(\".office-input > input[name='office_name']\").val($(this).data(\"office-name\"));\n    $(\".office-input > textarea[name='office_desc']\").val($(this).data(\"office-desc\"));\n    formOffice.attr(\"action\", \"/administrator/modify/office\");\n    btnOfficeSave.html(\"수정\");\n    btnDeleteOffice.prop(\"disabled\", false);\n  });\n\n  // 지사 .. 수정모드에서 등록모드로 변경\n  btnOfficeClearInputs.bind(\"click\", function () {\n    $(\".office-input > input[name='id']\").val(\"\");\n    $(\".office-input > input[name='office_name']\").val(\"\");\n    $(\".office-input > textarea[name='office_desc']\").val(\"\");\n    formOffice.attr(\"action\", \"/administrator/regist/office\");\n    btnOfficeSave.html(\"등록\");\n    btnDeleteOffice.prop(\"disabled\", true);\n  });\n\n  btnDeleteOffice.bind(\"click\", function () {\n    if (!window.confirm(\"삭제 시 되돌릴 수 없습니다. 정말 삭제하시겠습니까?\")) {\n      return false;\n    }\n\n    var params = { id: $(\".office-input > input[name='id'\").val() };\n\n    window.axios.delete(\"/administrator/office\",\n      {\n        params: params\n      })\n      .then(function (response) {\n        if (!response.data.success) {\n          window.alert(\"지사를 삭제하지 못했습니다.\");\n        } else {\n          window.alert(\"지사를 삭제하였습니다.\");\n        }\n        window.location.reload();\n      })\n      .catch(function (error) {\n        console.log(error);\n      });\n  });\n\n  // 점포 ..등록모드에서 수정모드로 변경\n  // 2nd 페이지에서 이벤트 안먹히는 증상 (http://stackoverflow.com/questions/25414778/jquery-onclick-not-working-in-datatables-2nd-page-or-rows-past-11)\n  $(\"#table-branch\").on(\"click\", \".branch-list-item\", function (e) {\n    e.preventDefault();\n    $(\".branch-input > input[name='id']\").val($(this).data(\"id\"));\n    $(\".branch-input > input[name='name']\").val($(this).data(\"name\"));\n    formBranch.attr(\"action\", \"/employee/modify/branch\");\n    btnBranchSave.html(\"수정\");\n    btnDeleteBranch.prop(\"disabled\", false);\n  });\n\n// 점포 .. 수정모드에서 등록모드로 변경\n  btnBranchClearInputs.bind(\"click\", function () {\n    $(\".branch-input > input[name='id']\").val(\"\");\n    $(\".branch-input > input[name='name']\").val(\"\");\n    formBranch.attr(\"action\", \"/employee/create/branch\");\n    btnBranchSave.html(\"등록\");\n    btnDeleteBranch.prop(\"disabled\", true);\n  });\n\n  // 점포 삭제하기\n  btnDeleteBranch.bind(\"click\", function () {\n    if (!confirm(\"삭제 시 되돌릴 수 없습니다. 정말 삭제하시겠습니까?\")) {\n      return false;\n    }\n\n    var params = {\n      id: $(\".branch-input > input[name='id'\").val()\n    };\n\n    axios.delete(\"/employee/branch\",\n      {\n        params: params\n      })\n      .then(function (response) {\n        if (!response.data.success) {\n          alert(\"점포을 삭제하지 못했습니다.\");\n        } else {\n          alert(\"점포을 삭제하였습니다.\");\n        }\n        location.reload();\n      })\n      .catch(function (error) {\n        console.log(error);\n      });\n  });\n\n  // 직책 ..등록모드에서 수정모드로 변경\n  dutyList.bind(\"click\", function (e) {\n    e.preventDefault();\n    $(\".duty-input > input[name='id'\").val($(this).data(\"id\"));\n    $(\".duty-input > input[name='name']\").val($(this).data(\"name\"));\n    formDuty.attr(\"action\", \"/employee/modify/duty\");\n    btnDutySave.html(\"수정\");\n    btnDeleteDuty.prop(\"disabled\", false);\n  });\n\n  // 직책 .. 수정모드에서 등록모드로 변경\n  btnDutyClearInputs.bind(\"click\", function () {\n    $(\".duty-input > input[name='id']\").val(\"\");\n    $(\".duty-input > input[name='name']\").val(\"\");\n\n    formDuty.attr(\"action\", \"/employee/create/duty\");\n    btnDutySave.html(\"등록\");\n    btnDeleteDuty.prop(\"disabled\", true);\n  });\n\n  // 직책 삭제하기\n  btnDeleteDuty.bind(\"click\", function () {\n    if (!confirm(\"삭제 시 되돌릴 수 없습니다. 정말 삭제하시겠습니까?\")) {\n      return false;\n    }\n\n    var params = {\n      id: $(\".duty-input > input[name='id'\").val()\n    };\n\n    axios.delete(\"/employee/duty\",\n      {\n        params: params\n      })\n      .then(function (response) {\n        if (!response.data.success) {\n          alert(\"직책을 삭제하지 못했습니다.\");\n        } else {\n          alert(\"직책을 삭제하였습니다.\");\n        }\n        location.reload();\n      })\n      .catch(function (error) {\n        console.log(error);\n      });\n  });\n});\n"],"sourceRoot":"/source/"}