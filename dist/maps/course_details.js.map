{"version":3,"sources":["course_details.js"],"names":["window","requirejs","Util","session","method","axios","url","data","title","course_list_id","children","course_list_order","index","promises","items","$","makeSessionOrderChangeRequest","push","acct","success","then","alert","perms","deleteSession","params","delete","response","btnDeleteSession","bind","confirm","location","reload","preventDefault","catch","error","btnSolveQuiz","btnPreviewChecklist","btnCreateVideo","btnCreateFinalQuiz","btnCreateChecklist","btnModifySession","btnDeleteCourse","connectWith","sortable","start","e","ui","this","attr","item","update","changeSessionOrder","courseListId","createWindowPopup","parent","btnWatch","windowOption","videoId","id","console","href","courseId","dataTitle","dataType","quizGroupId","btnCreateQuiz","course_list_type","dataCourseId","dataCourseListId","dataQuizGroupId","dataChecklistGroupId","checklist_group_id","dataVideoId"],"mappings":"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","file":"course_details.js","sourcesContent":["\"use strict\";\nwindow.requirejs([\"common\"], function(Util) {\n  var $ = $ || window.$;\n  var windowOption =\n    \"scrollbars=yes, toolbar=no, location=no, status=no, menubar=no, \" +\n    \"resizable=yes, width=1040, height=760, left=0, top=0\";\n  var btnWatch = window.$(\".btn-watch-video\");\n  var btnSolveQuiz = window.$(\".btn-solve-quiz\"); // 퀴즈/파이널테스트 보기\n  var btnPreviewChecklist = window.$(\".btn-preview-checklist\"); // 체크리스트 보기\n  var btnCreateVideo = window.$(\".btn-create-video\"); // 비디오 보기\n  // var btnModifyVideo = window.$('.btn-modify-video'); // 비디오 수정\n  var btnCreateQuiz = window.$(\".btn-create-quiz\"); // 퀴즈 생성\n  var btnCreateFinalQuiz = window.$(\".btn-create-final\"); // 파이널테스트 생성\n  var btnCreateChecklist = window.$(\".btn-create-checklist\"); // 파이널테스트 생성\n  var btnDeleteSession = window.$(\".btn-delete-session\"); // 세션 삭제버튼\n  var btnModifySession = window.$(\".btn-modify-session\"); // 세션 수정버튼\n  var btnDeleteCourse = window.$(\"#btnDeleteCourse\"); // 강의 삭제 버튼\n\n  window.$(function() {\n    // jQuery UI sortable 초기화\n    $(\".list-group\").sortable({\n      connectWith: \".list-group-item\",\n      start: function(e, ui) {\n        $(this).attr(\"data-previndex\", ui.item.index());\n      },\n      update: function(e, ui) {\n        // var newIndex = ui.item.index();\n        // var oldIndex = window.$(this).attr('data-previndex');\n        // window.console.log('newIndex : ' + newIndex + ' oldIndex : ' + oldIndex);\n        $(this).removeAttr(\"data-previndex\");\n        changeSessionOrder();\n      }\n    });\n    // window.$('.course-session').sortable({\n    //   placeholder: 'sort-highlight',\n    //   handle: '.handle',\n    //   forcePlaceholderSize: true,\n    //   zIndex: 999999,\n    //   start: function (e, ui) {\n    //     window.$(this).attr('data-previndex', ui.item.index());\n    //   },\n    //   update: function (e, ui) {\n    //     // var newIndex = ui.item.index();\n    //     // var oldIndex = window.$(this).attr('data-previndex');\n    //     // window.console.log('newIndex : ' + newIndex + ' oldIndex : ' + oldIndex);\n    //     window.$(this).removeAttr('data-previndex');\n    //     changeSessionOrder();\n    //   }\n\n    window.winpop_listener = function(data) {\n      if (data === true) {\n        window.location.reload(true);\n      }\n    };\n  });\n\n  /**\n   * DB 에서 세션 순서를 변경한다.\n   */\n  function makeSessionOrderChangeRequest(session) {\n    return window.axios({\n      method: \"put\",\n      url: \"/course/courselist\",\n      data: {\n        title: session.children(\"a\").data(\"title\"),\n        course_list_id: session.children(\"a\").data(\"id\"),\n        course_list_order: session.index()\n      }\n    });\n  }\n\n  /**\n   * 세션순서를 변경한다.\n   */\n  function changeSessionOrder() {\n    var promises = [];\n    var items = window.$(\".session-content > .list-group-item\");\n\n    for (var index = 0; index < items.length; index++) {\n      promises.push(makeSessionOrderChangeRequest(window.$(items[index])));\n    }\n\n    window.axios.all(promises).then(\n      window.axios.spread(function(acct, perms) {\n        if (acct.data.success) {\n          window.alert(\"세션순서를 변경하였습니다.\");\n        }\n      })\n    );\n  }\n\n  // 체크리스트 보기\n  btnPreviewChecklist.bind(\"click\", function(e) {\n    e.preventDefault();\n    var courseListId = window\n      .$(this)\n      .parent(\"span\")\n      .data(\"course-list-id\");\n    if (!courseListId) {\n      courseListId = window.$(this).data(\"id\");\n    }\n    Util.createWindowPopup(\"/course/checklist?course_list_id=\" + courseListId, \"Checklist\", windowOption);\n  });\n\n  // 비디오 보기\n  btnWatch.bind(\"click\", function(e) {\n    e.preventDefault();\n\n    // 비디오 아이디를 추출\n    var videoId = window.$(this).attr(\"data-video-id\");\n    Util.createWindowPopup(\"/course/video?id=\" + videoId, \"Video\", windowOption);\n  });\n\n  // 강의 삭제하기\n  btnDeleteCourse.bind(\"click\", function() {\n    if (!window.confirm(\"삭제 시 되돌릴 수 없습니다. 정말 삭제하시겠습니까?\")) {\n      return false;\n    }\n\n    var params = {\n      id: window.$(this).data(\"course-id\")\n    };\n\n    window.axios\n      .delete(\"/course/deactivate\", {\n        params: params\n      })\n      .then(function(response) {\n        if (!response.data.success) {\n          window.alert(\"강의를 삭제하였습니다.\");\n        } else {\n          window.alert(\"강의를 삭제하였습니다.\");\n          window.location.href = \"/course\";\n        }\n      })\n      .catch(function(error) {\n        console.log(error);\n      });\n  });\n\n  // 비디오 생성하기\n  btnCreateVideo.bind(\"click\", function(e) {\n    e.preventDefault();\n\n    var courseId = window.$(this).attr(\"data-course-id\");\n    Util.createWindowPopup(\"/course/create/video?course_id=\" + courseId, \"Video\", windowOption);\n  });\n\n  // 퀴즈 풀어보기\n  btnSolveQuiz.bind(\"click\", function(e) {\n    e.preventDefault();\n\n    var quizGroupId = window.$(this).attr(\"data-quiz-group\");\n    var dataTitle = window.$(this).attr(\"data-title\");\n    var dataType = window.$(this).attr(\"data-type\");\n\n    Util.createWindowPopup(\n      \"/course/quiz?id=\" + quizGroupId + \"&title=\" + dataTitle + \"&type=\" + dataType,\n      \"Quiz\",\n      windowOption\n    );\n  });\n\n  // 퀴즈 생성하기\n  btnCreateQuiz.bind(\"click\", function(e) {\n    e.preventDefault();\n\n    var courseId = window.$(this).attr(\"data-course-id\");\n    Util.createWindowPopup(\"/course/create/quiz?course_id=\" + courseId + \"&type=QUIZ\", \"Quiz\", windowOption);\n  });\n\n  // 파이널테스트 생성하기\n  btnCreateFinalQuiz.bind(\"click\", function(e) {\n    e.preventDefault();\n\n    var courseId = window.$(this).attr(\"data-course-id\");\n    Util.createWindowPopup(\"/course/create/quiz?course_id=\" + courseId + \"&type=FINAL\", \"Final\", windowOption);\n  });\n\n  // 파이널테스트 생성하기\n  btnCreateChecklist.bind(\"click\", function(e) {\n    e.preventDefault();\n\n    var courseId = window.$(this).attr(\"data-course-id\");\n    Util.createWindowPopup(\"/course/create/checklist?course_id=\" + courseId + \"&type=CHECK\", \"Checklist\", windowOption);\n  });\n\n  /**\n   * 세션관련정보를 삭제한다.\n   * 주의사항:\n   * 세션과 관련된 일체를 실제 삭제하는 기능이므로, 꼭 필요한 경우에만 사용하도록 할 필요가 있다.\n   * 1. 세션정보(course_list) 삭제\n   * 2. 퀴즈 보기(quiz_option) 삭제\n   * 3. 퀴즈(quiz) 를 삭제한다.\n   * 4. 퀴즈 보기 그룹(quiz_group) 삭제\n   */\n  function deleteSession(params) {\n    window.axios\n      .delete(\"/course/courselist\", {\n        params: params\n      })\n      .then(function(response) {\n        if (!response.data.success) {\n          window.alert(\"진행한 이력이 있어 세션을 삭제하지 못했습니다. 관리자에게 문의해주시기 바랍니다.\");\n        } else {\n          window.alert(\"세션을 삭제하였습니다.\");\n          window.location.reload();\n        }\n      })\n      .catch(function(error) {\n        console.log(error);\n      });\n  }\n\n  /**\n   * 세션을 삭제한다.\n   *\n   */\n  btnDeleteSession.bind(\"click\", function(e) {\n    e.preventDefault();\n\n    if (!window.confirm(\"삭제 시 되돌릴 수 없습니다. 정말 삭제하시겠습니까?\")) {\n      return false;\n    }\n\n    var params = {};\n    params.course_list_id = window\n      .$(this)\n      .parent(\"span\")\n      .data(\"course-list-id\");\n    params.course_list_type = window\n      .$(this)\n      .parent(\"span\")\n      .data(\"type\");\n\n    var courselistType = window\n      .$(this)\n      .parent(\"span\")\n      .data(\"type\");\n    switch (courselistType) {\n    case \"QUIZ\":\n    case \"FINAL\":\n      params.quiz_group_id = window.$(this).data(\"quiz-group\");\n      break;\n    case \"VIDEO\":\n      params.video_id = window.$(this).data(\"video-id\");\n      break;\n    case \"CHECKLIST\":\n      params.checklist_group_id = window.$(this).data(\"checklist-group\");\n      break;\n    default:\n      break;\n    }\n    deleteSession(params);\n  });\n\n  /**\n   * 세션 수정하기\n   */\n  btnModifySession.bind(\"click\", function(e) {\n    e.preventDefault();\n\n    var dataCourseId = window\n      .$(this)\n      .parent(\"span\")\n      .data(\"course-id\");\n    var dataCourseListId = window\n      .$(this)\n      .parent(\"span\")\n      .data(\"course-list-id\");\n    var dataVideoId = window.$(this).data(\"video-id\");\n    var dataQuizGroupId = window.$(this).data(\"quiz-group\");\n    var dataChecklistGroupId = window.$(this).data(\"checklist-group\");\n    var dataType = window\n      .$(this)\n      .parent(\"span\")\n      .data(\"type\"); // VIDEO/QUIZ/FINAL\n\n    if (dataType === \"VIDEO\") {\n      Util.createWindowPopup(\n        \"/course/modify/video?course_id=\" +\n          dataCourseId +\n          \"&course_list_id=\" +\n          dataCourseListId +\n          \"&video_id=\" +\n          dataVideoId,\n        \"Video\",\n        windowOption\n      );\n    } else if (dataType === \"QUIZ\" || dataType === \"FINAL\") {\n      Util.createWindowPopup(\n        \"/course/modify/quiz?course_id=\" +\n          dataCourseId +\n          \"&course_list_id=\" +\n          dataCourseListId +\n          \"&type=\" +\n          dataType +\n          \"&quiz_group_id=\" +\n          dataQuizGroupId,\n        \"Quiz\",\n        windowOption\n      );\n    } else if (dataType === \"CHECKLIST\") {\n      Util.createWindowPopup(\n        \"/course/modify/checklist?course_id=\" +\n          dataCourseId +\n          \"&course_list_id=\" +\n          dataCourseListId +\n          \"&type=\" +\n          dataType +\n          \"&checklist_group_id=\" +\n          dataChecklistGroupId,\n        \"Checklist\",\n        windowOption\n      );\n    }\n  });\n\n  /**\n   * DB 에서 세션 순서를 변경한다.\n   */\n  // function makeSessionOrderChangeRequest (session) {\n  //   return window.axios({\n  //     method: 'put',\n  //     url: '/course/courselist',\n  //     data: {\n  //       title: session.children().children('a').data('title'),\n  //       course_list_id: session.children().children('a').data('id'),\n  //       course_list_order: session.index()\n  //     }\n  //   });\n  // }\n\n  // /**\n  //  * 세션순서를 변경한다.\n  //  */\n  // function changeSessionOrder () {\n  //   var promises = [];\n  //   var items = window.$('.session-list');\n\n  //   for (var index = 0; index < items.length; index++) {\n  //     promises.push(makeSessionOrderChangeRequest(window.$(items[index])));\n  //   }\n\n  //   window.axios.all(promises).then(function (results) {\n  //     results.forEach(function (response) {\n  //     });\n  //   });\n  // }\n});\n"],"sourceRoot":"/source/"}