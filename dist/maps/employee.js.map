{"version":3,"sources":["employee.js"],"names":["window","requirejs","btnUploadEmployeeExcel","$","uploadEmployeeExcel","alert","files","length","focus","formData","prop","document","getElementById","FormData","axios","post","then","res","data","success","console","log","error","message","catch","select2","on","e","buttons","text","className","exportOptions","extend","btnBranchClearInputs","btnBranchSave","formBranch","btnDeleteDuty","btnDeleteBranch","dutyList","btnDutyClearInputs","btnDutySave","_self","formDuty","attr","this","_target","val","_phone","find","_name","_email","_userid","_branch","trigger","_duty","preventDefault","html","bind","params","id","location","reload","response","confirm","delete"],"mappings":"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","file":"employee.js","sourcesContent":["/**\n * Created by yijaejun on 30/11/2016.\n */\n\"use strict\";\nwindow.requirejs([\n  \"common\"\n],\nfunction (Util) {\n  var $ = $ || window.$;\n  var btnUploadEmployeeExcel = $(\"#js--btn-upload-employee-excel\");\n\n  $(function () {\n    $(\"#createEmployee #select_branch\").select2();\n    $(\"#modifyEmployee #select_branch\").select2();\n  });\n\n  btnUploadEmployeeExcel.on(\"click\", function (e) {\n    e.preventDefault();\n\n    uploadEmployeeExcel();\n  });\n\n  /**\n   * 교육 대상자를 저장한다.\n   */\n  function uploadEmployeeExcel () {\n    if (document.getElementById(\"exampleInputFile\").files.length === 0) {\n      $(\"#exampleInputFile\").focus();\n      window.alert(\"파일을 선택하세요.\");\n      return false;\n    }\n\n    if (!window.confirm(\"파일을 업로드하시겠습니까?\")) return false;\n\n    btnUploadEmployeeExcel.prop(\"disabled\", true);\n    var formData = new window.FormData();\n    formData.append(\"file\", document.getElementById(\"exampleInputFile\").files[0]);\n\n    window.axios.post(\"/upload/excel/create/employee\", formData)\n      .then(function (res) {\n        if (res.data) {\n          btnUploadEmployeeExcel.prop(\"disabled\", false);\n\n          if (res.data.success !== false) {\n            window.alert(\"업로드 완료\");\n          } else {\n            window.alert(\"업로드에 실패하였습니다.\\n핸드폰번호 또는 이메일 중복여부를 확인하세요.\");\n            console.log(res.data.message);\n          }\n        }\n      })\n      .catch(function (error) {\n        console.log(error);\n      });\n  }\n\n  // datatable 설정\n  Util.initDataTable($(\"#table-branch\"), {\n    buttons: []\n  });\n  Util.initDataTable($(\"#table-employee\"), {\n    buttons:\n    [\n      {\n        text: \"<i class=\\\"fa fa-copy\\\"></i> 복사\",\n        extend: \"copy\",\n        className: \"btn-sm btn-default\",\n        exportOptions: {\n          columns: [ 0, 1, 2, 3, 4 ]\n        }\n      },\n      {\n        text: \"<i class=\\\"fa fa-download\\\"></i> 엑셀\",\n        extend: \"excel\",\n        className: \"btn-sm btn-default\",\n        exportOptions: {\n          columns: [ 0, 1, 2, 3, 4 ]\n        }\n      }\n    ]\n  });\n\n  var btnBranchClearInputs = $(\".branch-right-buttons > #clear-input\");\n  var btnBranchSave = $(\".branch-right-buttons > .btn-submit\");\n  var formBranch = $(\"#frm_create_branch\");\n  var btnDeleteBranch = $(\"#btnDisableBranch\");\n  var dutyList = $(\".duty-list > a\");\n  var btnDutyClearInputs = $(\".duty-right-buttons > #clear-input\");\n  var btnDutySave = $(\".duty-right-buttons > .btn-submit\");\n  var formDuty = $(\"#frm_create_duty\");\n  var btnDeleteDuty = $(\"#btnDisableDuty\");\n\n  // 직원정보 수정 페이지 호출\n  $(\"#table-employee\").on(\"click\", \".btn-modify-userinfo\", function (e) {\n    var _self = $(this);\n    var _name = _self.attr(\"data-user-name\");\n    var _branch = _self.attr(\"data-user-branch\");\n    var _duty = _self.attr(\"data-user-duty\");\n    var _phone = _self.attr(\"data-user-phone\");\n    var _email = _self.attr(\"data-user-email\");\n    var _userid = _self.attr(\"data-user-id\");\n    var _target = $(\"#frm_modify_employee\");\n\n    _target.find(\"#name\").val(_name);\n    _target.find(\"#tel\").val(_phone);\n    _target.find(\"#email\").val(_email);\n    _target.find(\".employee_id\").val(_userid);\n    _target.find(\"#select_branch\").val(_branch).trigger(\"change\"); // select2 의 선택방식은 다르다.\n    _target.find(\"#select_duty\").val(_duty);\n  });\n\n  // $('.btn-modify-userinfo').bind('click', function () {\n  //   var _self = $(this);\n  //   console.log(_self);\n  //   var _name = _self.attr('data-user-name');\n  //   var _branch = _self.attr('data-user-branch');\n  //   var _duty = _self.attr('data-user-duty');\n  //   var _phone = _self.attr('data-user-phone');\n  //   var _email = _self.attr('data-user-email');\n  //   var _userid = _self.attr('data-user-id');\n  //   var _target = $('#frm_modify_employee');\n\n  //   _target.find('#name').val(_name);\n  //   _target.find('#tel').val(_phone);\n  //   _target.find('#email').val(_email);\n  //   _target.find('.employee_id').val(_userid);\n  //   _target.find('#select_branch').val(_branch).trigger('change'); // select2 의 선택방식은 다르다.\n  //   _target.find('#select_duty').val(_duty);\n  // });\n\n  // 점포 ..등록모드에서 수정모드로 변경\n  // 2nd 페이지에서 이벤트 안먹히는 증상 (http://stackoverflow.com/questions/25414778/jquery-onclick-not-working-in-datatables-2nd-page-or-rows-past-11)\n  $(\"#table-branch\").on(\"click\", \".branch-list-item\", function (e) {\n    e.preventDefault();\n    $(\".branch-input > input[name='id']\").val($(this).data(\"id\"));\n    $(\".branch-input > input[name='name']\").val($(this).data(\"name\"));\n    formBranch.attr(\"action\", \"/employee/modify/branch\");\n    btnBranchSave.html(\"수정\");\n    btnDeleteBranch.prop(\"disabled\", false);\n  });\n\n  // 점포 .. 수정모드에서 등록모드로 변경\n  btnBranchClearInputs.bind(\"click\", function () {\n    $(\".branch-input > input[name='id']\").val(\"\");\n    $(\".branch-input > input[name='name']\").val(\"\");\n    formBranch.attr(\"action\", \"/employee/create/branch\");\n    btnBranchSave.html(\"등록\");\n    btnDeleteBranch.prop(\"disabled\", true);\n  });\n\n  // 직책 ..등록모드에서 수정모드로 변경\n  dutyList.bind(\"click\", function (e) {\n    e.preventDefault();\n    $(\".duty-input > input[name='id'\").val($(this).data(\"id\"));\n    $(\".duty-input > input[name='name']\").val($(this).data(\"name\"));\n    formDuty.attr(\"action\", \"/employee/modify/duty\");\n    btnDutySave.html(\"수정\");\n    btnDeleteDuty.prop(\"disabled\", false);\n  });\n\n  // 직책 .. 수정모드에서 등록모드로 변경\n  btnDutyClearInputs.bind(\"click\", function () {\n    $(\".duty-input > input[name='id']\").val(\"\");\n    $(\".duty-input > input[name='name']\").val(\"\");\n\n    formDuty.attr(\"action\", \"/employee/create/duty\");\n    btnDutySave.html(\"등록\");\n    btnDeleteDuty.prop(\"disabled\", true);\n  });\n\n  // 직원 삭제하기\n  $(\"#table-employee\").on(\"click\", \".btn-delete-employee\", function () {\n    if (!confirm(\"삭제 시 되돌릴 수 없습니다. 정말 삭제하시겠습니까?\")) {\n      return false;\n    }\n\n    var params = {\n      id: $(this).data(\"user-id\")\n    };\n\n    axios.delete(\"/employee\",\n      {\n        params: params\n      })\n      .then(function (response) {\n        if (!response.data.success) {\n          alert(\"직원을 삭제하지 못했습니다.\");\n        } else {\n          alert(\"직원을 삭제하였습니다.\");\n        }\n        location.reload();\n      })\n      .catch(function (error) {\n        console.log(error);\n      });\n  });\n\n  // 점포 삭제하기\n  btnDeleteBranch.bind(\"click\", function () {\n    if (!confirm(\"삭제 시 되돌릴 수 없습니다. 정말 삭제하시겠습니까?\")) {\n      return false;\n    }\n\n    var params = {\n      id: $(\".branch-input > input[name='id'\").val()\n    };\n\n    axios.delete(\"/employee/branch\",\n      {\n        params: params\n      })\n      .then(function (response) {\n        if (!response.data.success) {\n          alert(\"점포을 삭제하지 못했습니다.\");\n        } else {\n          alert(\"점포을 삭제하였습니다.\");\n        }\n        location.reload();\n      })\n      .catch(function (error) {\n        console.log(error);\n      });\n  });\n\n  // 직책 삭제하기\n  btnDeleteDuty.bind(\"click\", function () {\n    if (!confirm(\"삭제 시 되돌릴 수 없습니다. 정말 삭제하시겠습니까?\")) {\n      return false;\n    }\n\n    var params = {\n      id: $(\".duty-input > input[name='id'\").val()\n    };\n\n    axios.delete(\"/employee/duty\",\n      {\n        params: params\n      })\n      .then(function (response) {\n        if (!response.data.success) {\n          alert(\"직책을 삭제하지 못했습니다.\");\n        } else {\n          alert(\"직책을 삭제하였습니다.\");\n        }\n        location.reload();\n      })\n      .catch(function (error) {\n        console.log(error);\n      });\n  });\n});\n"],"sourceRoot":"/source/"}